---
export async function handleRegister(e) {
  e.preventDefault();
  const formData = new FormData(e.target);
  const newUser = {
    nombre: formData.get('nombre'),
    email: formData.get('email'),
    contraseña: formData.get('contraseña'),
    rol: 'user'
  };

  console.log('Datos del usuario a enviar:', newUser); // Verifica lo que se está enviando
  const response = await fetch('http://localhost:3000/users', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(newUser),
  });

  console.log('Estado de la respuesta:', response.status); // Registra el estado HTTP
  console.log('Respuesta OK:', response.ok); // Verifica si la respuesta es OK
  if (response.ok) {
    console.log('Usuario creado con éxito');
    window.location.href = '/iniciar-sesion';
  } else {
    const errorData = await response.json();
    console.error('Error al crear usuario:', errorData);
    alert('Error al crear la cuenta: ' + (errorData.error || 'Desconocido'));
  }
}
---

<form onSubmit={handleRegister} class="bg-white p-6 shadow-md rounded-md max-w-md w-full">
  <div class="mb-4">
    <label for="nombre" class="block font-bold text-gray-600">Nombre</label>
    <input type="text" name="nombre" id="nombre" required 
      class="border border-gray-300 rounded-md p-2 w-full focus:outline-none focus:ring focus:ring-blue-300">
  </div>
  <div class="mb-4">
    <label for="email" class="block font-bold text-gray-600">Correo Electrónico</label>
    <input type="email" name="email" id="email" required 
      class="border border-gray-300 rounded-md p-2 w-full focus:outline-none focus:ring focus:ring-blue-300">
  </div>
  <div class="mb-6">
    <label for="contraseña" class="block font-bold text-gray-600">Contraseña</label>
    <input type="password" name="contraseña" id="contraseña" required 
      class="border border-gray-300 rounded-md p-2 w-full focus:outline-none focus:ring focus:ring-blue-300">
  </div>
  <button type="submit" class="bg-[#84B6F4] text-white font-bold py-2 px-4 rounded hover:bg-blue-500 transition">
    Crear Cuenta
  </button>
</form>